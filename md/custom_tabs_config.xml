<?xml version="1.0" encoding="utf-8"?>
<mdscript name="MCT_Config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../../#modding/xsd/md.xsd">
    <cues>
        <cue name="RegisterMenu" instantiate="true">
            <conditions>
                <event_cue_signalled cue="md.Simple_Menu_Options.Reloaded"/>
            </conditions>
            <actions>
                <signal_cue_instantly
                        cue="md.Simple_Menu_API.Register_Options_Menu"
                        param="table[
                            $id = 'custom_tabs_extension_options_menu',
                            $columns = 12,
                            $title = {26124, 100},
                            $onOpen = OptionsMenu
                        ]"/>
                <cancel_cue cue="this"/>
            </actions>
        </cue>
        <cue name="Vault" namespace="this" version="4">
            <actions>
                <set_value name="$debugPrefix" exact="'Mycu MCT: '"/>
                <set_value name="$debugChance" exact="0"/>

                <debug_text text="$debugPrefix + 'Vault INIT'" chance="$debugChance"/>

                <set_value name="$customTabs" exact="table[
                    $mode = 'move',
                    $modeIndex = 1,
                    $number = 3,
                    $position = 2,
                    $order = [1,2,3,4,5,6,7,8,9],

                    $tab1 = table[
                        $name = {26124, 200}+ ' A',
                        $icon = table[
                            $name = 'mct_icon_a',
                            $index = 1,
                        ],
                    ],
                    $tab2 = table[
                        $name = {26124, 200}+ ' B',
                        $icon = table[
                            $name = 'mct_icon_b',
                            $index = 2,
                        ],
                    ],
                    $tab3 = table[
                        $name = {26124, 200}+ ' C',
                        $icon = table[
                            $name = 'mct_icon_c',
                            $index = 3,
                        ],
                    ],
                    $tab4 = table[
                        $name = {26124, 200}+ ' D',
                        $icon = table[
                            $name = 'mct_icon_d',
                            $index = 4,
                        ],
                    ],
                    $tab5 = table[
                        $name = {26124, 200}+ ' E',
                        $icon = table[
                            $name = 'mct_icon_e',
                            $index = 5,
                        ],
                    ],
                    $tab6 = table[
                        $name = {26124, 200}+ ' F',
                        $icon = table[
                            $name = 'mct_icon_f',
                            $index = 6,
                        ],
                    ],
                    $tab7 = table[
                        $name = {26124, 200}+ ' G',
                        $icon = table[
                            $name = 'mct_icon_g',
                            $index = 7,
                        ],
                    ],
                    $tab8 = table[
                        $name = {26124, 200}+ ' H',
                        $icon = table[
                            $name = 'mct_icon_h',
                            $index = 8,
                        ],
                    ],
                    $tab9 = table[
                        $name = {26124, 200}+ ' I',
                        $icon = table[
                            $name = 'mct_icon_i',
                            $index = 9,
                        ],
                    ],

                    $disableVanillaTabs1 = 0,
                    $disableVanillaTabs2 = 0,
                    $disableVanillaTabs3 = 0,
                    $disableVanillaTabs4 = 0,
                    $disableVanillaTabs5 = 0,
                    $resetConfirm = 0,
                ]"/>

                <set_value name="player.entity.$customTabsConfig" exact="$customTabs"/>
            </actions>
            <patch sinceversion="2">
                <set_value name="$customTabs.$mode" exact="'move'"/>
                <set_value name="$customTabs.$modeIndex" exact="1"/>
            </patch>
            <patch sinceversion="3"><!-- compatibility with internal testing --></patch>
            <patch sinceversion="4">
                <set_value name="$customTabs.$order" exact="[1,2,3,4,5,6,7,8,9]"/>

                <set_value name="$customTabs.$tab1" exact="table[
                    $name = $customTabs.$tabName1,
                    $icon = table[
                        $name = $customTabs.$tabIcon1,
                        $index = $customTabs.$tabIcon1Index,
                    ],
                ]"/>
                <set_value name="$customTabs.$tab2" exact="table[
                    $name = $customTabs.$tabName2,
                    $icon = table[
                        $name = $customTabs.$tabIcon2,
                        $index = $customTabs.$tabIcon2Index,
                    ],
                ]"/>
                <set_value name="$customTabs.$tab3" exact="table[
                    $name = $customTabs.$tabName3,
                    $icon = table[
                        $name = $customTabs.$tabIcon3,
                        $index = $customTabs.$tabIcon3Index,
                    ],
                ]"/>
                <set_value name="$customTabs.$tab4" exact="table[
                    $name = {26124, 200}+ ' D',
                    $icon = table[
                        $name = 'mct_icon_d',
                        $index = 4,
                    ],
                ]"/>
                <set_value name="$customTabs.$tab5" exact="table[
                    $name = {26124, 200}+ ' E',
                    $icon = table[
                        $name = 'mct_icon_e',
                        $index = 5,
                    ],
                ]"/>
                <set_value name="$customTabs.$tab6" exact="table[
                    $name = {26124, 200}+ ' F',
                    $icon = table[
                        $name = 'mct_icon_f',
                        $index = 6,
                    ],
                ]"/>
                <set_value name="$customTabs.$tab7" exact="table[
                    $name = {26124, 200}+ ' G',
                    $icon = table[
                        $name = 'mct_icon_g',
                        $index = 7,
                    ],
                ]"/>
                <set_value name="$customTabs.$tab8" exact="table[
                    $name = {26124, 200}+ ' H',
                    $icon = table[
                        $name = 'mct_icon_h',
                        $index = 8,
                    ],
                ]"/>
                <set_value name="$customTabs.$tab9" exact="table[
                    $name = {26124, 200}+ ' I',
                    $icon = table[
                        $name = 'mct_icon_i',
                        $index = 9,
                    ],
                ]"/>

                <set_value name="$customTabs.$disableVanillaTabs1" exact="0"/>
                <set_value name="$customTabs.$disableVanillaTabs2" exact="0"/>
                <set_value name="$customTabs.$disableVanillaTabs3" exact="0"/>
                <set_value name="$customTabs.$disableVanillaTabs4" exact="0"/>
                <set_value name="$customTabs.$disableVanillaTabs5" exact="0"/>
            </patch>

        </cue>
        <cue name="OptionsMenu" instantiate="true">
            <conditions>
                <event_cue_signalled/>
            </conditions>
            <actions>
                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" param="table[$selectable=false]"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text" param="table[$col=1, $colSpan = 5, $text={26124, 203}, $color = 'Helper.color.blue']"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text" param="table[$col=1, $colSpan = 5, $text={26124, 204}, $color = 'Helper.color.white', $halign = 'right']"/>
                <!-- number of tabs -->
                <signal_cue_instantly
                        cue="md.Simple_Menu_API.Make_Slider"
                        param="table[
						$id = 'number',
						$start = md.MCT_Config.Vault.$customTabs.$number,
						$col = 6,
						$colSpan = 7,
						$height = 25,
						$text = table[$text=''],
						$min = 1, $max = 9, $step = 1,
						$default = md.MCT_Config.Vault.$customTabs.$number,
						$mouseOverText = {26124, 205},
						$onSliderCellConfirm = OnSliderChange
					]"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text" param="table[$col=1, $colSpan = 5, $text={26124, 206}, $color = 'Helper.color.white', $halign = 'right']"/>
                <!-- tabs position -->
                <signal_cue_instantly
                        cue="md.Simple_Menu_API.Make_Dropdown"
                        param="table[
						$id = 'position',
						$col = 6,
						$colSpan = 7,
						$height = 25,
						$options = [
							table[$text={26124, 207}, $id = 1, $value=1],
							table[$text={26124, 208}, $id = 2, $value=2],
							table[$text={26124, 209}, $id = 3, $value=3],
						],
						$startOption = md.MCT_Config.Vault.$customTabs.$position,
						$mouseOverText = {26124, 210},
						$onDropDownConfirmed = OnDropDownChange
					]"/>

                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text" param="table[$col=1, $colSpan = 5, $text={26124, 226}, $color = 'Helper.color.white', $halign = 'right']"/>
                <!-- tabs mode -->
                <signal_cue_instantly
                        cue="md.Simple_Menu_API.Make_Dropdown"
                        param="table[
						$id = 'mode',
						$col = 6,
						$colSpan = 7,
						$height = 25,
						$options = [
							table[$text={26124, 227}, $id = 1, $value='move'],
							table[$text={26124, 228}, $id = 2, $value='clone'],
						],
						$startOption = md.MCT_Config.Vault.$customTabs.$modeIndex,
						$mouseOverText = {26124, 229},
						$onDropDownConfirmed = OnDropDownChange
					]"/>


                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" param="table[$selectable=false]"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text" param="table[$col=1, $colSpan = 5, $text={26124, 260}, $color = 'Helper.color.blue']"/>

                <!-- disable vanilla tabs -->
                <set_value name="$disables" exact="table[
                    $row1 = table[
                        $disable1 = table[ $index = 1, $col = 1, $text = {26124, 261}, $mouseOverText = {26124, 270} ],
                        $disable2 = table[ $index = 2, $col = 6, $text = {26124, 262}, $mouseOverText = {26124, 270} ],
                    ],
                    $row2 = table[
                        $disable3 = table[ $index = 3, $col = 1, $text = {26124, 263}, $mouseOverText = {26124, 270} ],
                        $disable4 = table[ $index = 4, $col = 6, $text = {26124, 264}, $mouseOverText = {26124, 270} ],
                    ],
                    $row3 = table[
                        $disable5 = table[ $index = 5, $col = 1, $text = {26124, 265}, $mouseOverText = {26124, 270} ],
                    ]
                ]"/>

                <do_for_each valuename="$disableRow" in="$disables">
                    <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row"/>
                    <do_for_each valuename="$disable" in="$disableRow">
                        <signal_cue_instantly
                                cue="md.Simple_Menu_API.Make_CheckBox"
                                param="table[
                                    $id = 'disableVanillaTabs'+$disable.$index,
                                    $checked = md.MCT_Config.Vault.$customTabs.{'$disableVanillaTabs' + $disable.$index},
                                    $col = $disable.$col,
                                    $x = 35,
                                    $width = 'Helper.standardButtonHeight', $height = 'Helper.standardButtonHeight',
                                    $mouseOverText = $disable.$mouseOverText,
                                    $onClick = OnCheckboxClick,
                                ]"/>
                        <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text" param="table[$col=$disable.$col + 1, $colSpan = 4, $text=$disable.$text, $color = 'Helper.color.white']"/>
                    </do_for_each>
                </do_for_each>

                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text" param="table[$col=1, $text='']"/>

                <!-- tab definitions -->
                <set_value name="$tabs" exact="table[
                    $tab1 = table[
                        $label    = table[ $index = 1, $text = {26124, 211} ],
                        $input    = table[ $index = 1, $mouseover = {26124, 251} ],
                        $dropdown = table[ $index = 1, $mouseover = {26124, 230} ]
                    ],
                    $tab2 = table[
                        $label    = table[ $index = 2, $text = {26124, 212} ],
                        $input    = table[ $index = 2, $mouseover = {26124, 251} ],
                        $dropdown = table[ $index = 2, $mouseover = {26124, 230} ]
                    ],
                    $tab3 = table[
                        $label    = table[ $index = 3, $text = {26124, 213} ],
                        $input    = table[ $index = 3, $mouseover = {26124, 251} ],
                        $dropdown = table[ $index = 3, $mouseover = {26124, 230} ]
                    ],
                    $tab4 = table[
                        $label    = table[ $index = 4, $text = {26124, 214} ],
                        $input    = table[ $index = 4, $mouseover = {26124, 251} ],
                        $dropdown = table[ $index = 4, $mouseover = {26124, 230} ]
                    ],
                    $tab5 = table[
                        $label    = table[ $index = 5, $text = {26124, 215} ],
                        $input    = table[ $index = 5, $mouseover = {26124, 251} ],
                        $dropdown = table[ $index = 5, $mouseover = {26124, 230} ]
                    ],
                    $tab6 = table[
                        $label    = table[ $index = 6, $text = {26124, 216} ],
                        $input    = table[ $index = 6, $mouseover = {26124, 251} ],
                        $dropdown = table[ $index = 6, $mouseover = {26124, 230} ]
                    ],
                    $tab7 = table[
                        $label    = table[ $index = 7, $text = {26124, 217} ],
                        $input    = table[ $index = 7, $mouseover = {26124, 251} ],
                        $dropdown = table[ $index = 7, $mouseover = {26124, 230} ]
                    ],
                    $tab8 = table[
                        $label    = table[ $index = 8, $text = {26124, 218} ],
                        $input    = table[ $index = 8, $mouseover = {26124, 251} ],
                        $dropdown = table[ $index = 8, $mouseover = {26124, 230} ]
                    ],
                    $tab9 = table[
                        $label    = table[ $index = 9, $text = {26124, 219} ],
                        $input    = table[ $index = 9, $mouseover = {26124, 251} ],
                        $dropdown = table[ $index = 9, $mouseover = {26124, 230} ]
                    ]
                ]"/>

                <set_value name="$configs" exact="table[
                    $row1 = table[
                        $labels = [
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{1}}.$label,
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{2}}.$label,
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{3}}.$label,
                        ],
                        $inputs = [
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{1}}.$input,
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{2}}.$input,
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{3}}.$input,
                        ],
                        $dropdowns = [
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{1}}.$dropdown,
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{2}}.$dropdown,
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{3}}.$dropdown,
                        ]
                    ],
                    $row2 = table[
                        $labels = [
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{4}}.$label,
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{5}}.$label,
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{6}}.$label,
                        ],
                        $inputs = [
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{4}}.$input,
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{5}}.$input,
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{6}}.$input,
                        ],
                        $dropdowns = [
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{4}}.$dropdown,
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{5}}.$dropdown,
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{6}}.$dropdown,
                        ]
                    ],
                    $row3 = table[
                        $labels = [
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{7}}.$label,
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{8}}.$label,
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{9}}.$label,
                        ],
                        $inputs = [
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{7}}.$input,
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{8}}.$input,
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{9}}.$input,
                        ],
                        $dropdowns = [
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{7}}.$dropdown,
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{8}}.$dropdown,
                            $tabs.{'$tab'+md.MCT_Config.Vault.$customTabs.$order.{9}}.$dropdown,
                        ]
                    ]
                ]"/>

                <!-- icon definitions -->
                <set_value name="$icons" exact="[
                    'mct_icon_a',
                    'mct_icon_b',
                    'mct_icon_c',
                    'mct_icon_d',
                    'mct_icon_e',
                    'mct_icon_f',
                    'mct_icon_g',
                    'mct_icon_h',
                    'mct_icon_i',
                    'mct_icon_1',
                    'mct_icon_2',
                    'mct_icon_3',
                    'mct_icon_4',
                    'mct_icon_5',
                    'mct_icon_6',
                    'mct_icon_7',
                    'mct_icon_8',
                    'mct_icon_9',
                    'shipbuildst_shield',
                    'vt_guild',
                    'shipbuildst_turret',
                    'shipbuildst_weapon',
                    'shipbuildst_consumable',
                    'mapst_filtersystem',
                    'mapst_legend',
                    'mapst_fs_other',
                    'mapst_mission_guidance',
                    'tlt_help',
                    'mapst_information',
                    'mapst_fs_think',
                    'vt_exploration',
                    'mapst_mission_main',
                    'mapst_ol_ship_xl',
                    'mapst_ol_ship_l',
                    'mapst_ol_ship_m',
                    'mapst_ol_ship_s',
                    'mapst_ol_ships',
                    'mapst_ol_fleets',
                    'tlt_playerinfo',
                    'vt_team',
                    'mapst_mission_mentor',
                    'shipbuildst_crew',
                    'mapst_mission_guild',
                    'vt_contactlist',
                    'vt_reward_crewskill',
                    'mapst_loadout',
                    'tlt_optionsmenu',
                    'pi_logbook',
                    'tlt_encyclopedia',
                    'tlt_research',
                    'mapst_ao_orderqueue',
                    'mapst_standing_orders',
                    'mapst_fs_trade',
                    'mapst_plotmanagement',
                    'mapst_cheats',
                    'mapst_ol_inventory',
                    'mapst_ao_default_object',
                    'vt_season',
                    'mapst_ol_deployables',
                    'mapst_fs_trade',
                    'mapst_fs_fight',
                    'vt_aggressive',
                    'mapst_fs_diplomacy',
                    'mapst_fs_mining',
                    'mapst_ao_default_global',
                    'vt_reward_inventory',
                    'shipbuildst_paint',
                    'mapst_fs_build',
                    'vt_economic',
                    'tlt_map',
                    'tlt_shipinteractions',
                    'tlt_terraforming',
                ]"/>

                <set_value name="$dropdownOptions" exact="[]"/>
                <do_for_each name="$icon" in="$icons" counter="$i">
                    <append_to_list name="$dropdownOptions" exact="table[$text={26124, 232} + ' ' + $i, $id=$i, $value=$icon]"/>
                </do_for_each>

                <set_value name="$columns" exact="[1,5,9]"/>
                <set_value name="$row" exact="1"/>
                <do_for_each name="$id" valuename="$data" in="$configs">
                    <!-- labels -->
                    <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row"/>
                    <do_for_each name="$label" in="$data.$labels" counter="$i">
                        <do_if value="(3*($row-1) + $i) le md.MCT_Config.Vault.$customTabs.$number">
                            <signal_cue_instantly
                                    cue="md.Simple_Menu_API.Make_Text"
                                    param="table[
                                        $col= $columns.{$i},
                                        $colSpan = 4,
                                        $text=$label.$text,
                                        $color = 'Helper.color.blue'
                                 ]"/>
                        </do_if>
                    </do_for_each>

                    <!-- inputs -->
                    <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row"/>
                    <do_for_each name="$input" in="$data.$inputs" counter="$i">
                        <do_if value="(3*($row-1) + $i) le md.MCT_Config.Vault.$customTabs.$number">
                            <signal_cue_instantly
                                    cue="md.Simple_Menu_API.Make_EditBox"
                                    param="table[
                                        $id = $input.$index,
                                        $col = $columns.{$i},
                                        $colSpan = 4,
                                        $height = 25,
                                        $defaultText = md.MCT_Config.Vault.$customTabs.{'$tab' + $input.$index}.$name,
                                        $mouseOverText = $input.$mouseover,
                                        $onTextChanged = OnEditBoxChanged,
                                        $onEditBoxDeactivated = OnEditBoxDeactivated,
                                ]"/>
                        </do_if>
                    </do_for_each>

                    <!-- dropdowns -->
                    <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row"/>

                    <do_for_each name="$dropdown" in="$data.$dropdowns" counter="$i">
                        <do_if value="(3*($row-1) + $i) le md.MCT_Config.Vault.$customTabs.$number">
                            <signal_cue_instantly
                                    cue="md.Simple_Menu_API.Make_Dropdown"
                                    param="table[
                                        $id = $dropdown.$index,
                                        $col = $columns.{$i},
                                        $colSpan = 4,
                                        $height = 25,
                                        $options = $dropdownOptions,
                                        $startOption = md.MCT_Config.Vault.$customTabs.{'$tab' + $dropdown.$index}.$icon.$index,
                                        $mouseOverText = $dropdown.$mouseover,
                                        $onDropDownConfirmed = OnIconDropDownChange,
                            ]"/>
                        </do_if>
                    </do_for_each>

                    <do_if value="$row lt (md.MCT_Config.Vault.$customTabs.$number / 3) + 1">
                        <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row"/>
                        <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text" param="table[$col=1, $text='']"/>
                    </do_if>
                    <set_value name="$row" operation="add"/>
                </do_for_each>

                <!--
                    icon gallery
                    beacuse of the max table height (vertical space left doesn't suffice to display the requested table) - we need to trick it by displaying two icon tables
                -->
                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" param="table[$selectable=false]"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text" param="table[$col=1, $colSpan = 12, $text={26124, 231}, $color = 'Helper.color.blue', $halign = 'left']"/>

                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" param="table[$selectable=false]"/>

                <set_value name="$iconIndex" exact="1"/>
                <set_value name="$iconCountHalf" exact="$icons.count / 2"/>

                <do_for_each name="$icon" in="$icons" counter="$z">
                    <include_actions ref="Add_Icon_Actions"/>
                    <do_if value="$z ge $iconCountHalf">
                        <break/>
                    </do_if>
                </do_for_each>

                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" param="table[$selectable=false]"/>

                <do_for_each name="$icon" in="$icons" counter="$z">
                    <do_if value="$z le $iconCountHalf">
                        <continue/>
                    </do_if>
                    <include_actions ref="Add_Icon_Actions"/>
                </do_for_each>

                <!-- reorder tabs -->
                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text" param="table[$col=1, $text='']"/>

                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" param="table[$selectable=false]"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text" param="table[$id='resetText',  $col=1, $colSpan = 12, $text={26124, 300}, $color = 'Helper.color.blue', $halign = 'left', $selectable=false ]"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row"/>

                <set_value name="$reorderDropdownOptionsA" exact="[]"/>
                <do_for_each name="$order" in="md.MCT_Config.Vault.$customTabs.$order" counter="$i">
                    <do_if value="md.MCT_Config.Vault.$customTabs.$number ge $i">
                        <set_value name="$tabName" exact="md.MCT_Config.Vault.$customTabs.{'$tab'+ $order}.$name"/>
                        <append_to_list name="$reorderDropdownOptionsA" exact="table[$text={26124, 303} + ' ' + $tabName, $orderNumber = $order, $orderIndex=$i]"/>
                    </do_if>
                </do_for_each>

                <signal_cue_instantly
                        cue="md.Simple_Menu_API.Make_Dropdown"
                        param="table[
						    $id = 'reorder_from',
						    $col = 2,
						    $colSpan = 4,
						    $height = 25,
						    $options = $reorderDropdownOptionsA,
                            $startOption = '',
                            $mouseOverText = '',
                            $onDropDownConfirmed = OnDropDownReorderFromChange
					]"/>

                <set_value name="$reorderDropdownOptionsB" exact="[]"/>
                <append_to_list name="$reorderDropdownOptionsB" exact="table[$text={26124, 304}, $orderNumber = 0, $orderIndex=0]"/>
                <do_for_each name="$order" in="md.MCT_Config.Vault.$customTabs.$order" counter="$i">
                    <do_if value="md.MCT_Config.Vault.$customTabs.$number ge $i">
                        <set_value name="$tabName" exact="md.MCT_Config.Vault.$customTabs.{'$tab'+ $order}.$name"/>
                        <append_to_list name="$reorderDropdownOptionsB" exact="table[$text={26124, 305} + ' ' + $tabName, $orderNumber = $order, $orderIndex=$i]"/>
                    </do_if>
                </do_for_each>
                <signal_cue_instantly
                        cue="md.Simple_Menu_API.Make_Dropdown"
                        param="table[
						    $id = 'reorder_to',
						    $col = 6,
						    $colSpan = 4,
						    $height = 25,
						    $options = $reorderDropdownOptionsB,
                            $startOption = '',
                            $mouseOverText = '',
                            $onDropDownConfirmed = OnDropDownReorderToChange
					]"/>
                <signal_cue_instantly
                        cue="md.Simple_Menu_API.Make_Button"
                        param="table[
                            $id = 'reorderBtn',
                            $col = 10,
                            $colSpan = 3,
                            $height = 25,
                            $text = table[
                              $text   = {26124, 301},
                              $color  = 'Helper.color.grey',
                              $halign = 'center',
                            ],
                            $mouseOverText = {26124, 302},
                            $onClick = OnReorderButtonClick,
                        ]"/>


                <!-- emergency -->
                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text" param="table[$col=1, $text='']"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text" param="table[$col=1, $text='']"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text" param="table[$col=1, $text='']"/>

                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" param="table[$selectable=false]"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text" param="table[$id='resetText',  $col=1, $colSpan = 12, $text={26124, 220}, $color = 'Helper.color.blue', $halign = 'left', $selectable=false ]"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row"/>
                <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text" param="table[$col=1, $colSpan = 5, $text='', $color = 'Helper.color.white', $halign = 'right']"/>
                <signal_cue_instantly
                        cue="md.Simple_Menu_API.Make_CheckBox"
                        param="table[
                            $id = 'resetConfirm',
                            $checked = md.MCT_Config.Vault.$customTabs.$resetConfirm,
                            $col = 10,
                            $x = 35,
                            $width = 'Helper.standardButtonHeight', $height = 'Helper.standardButtonHeight',
                            $mouseOverText = {26124, 221},
                            $onClick = OnCheckboxClick,
	    				]"/>
                <signal_cue_instantly
                        cue="md.Simple_Menu_API.Make_Button"
                        param="table[
                            $col = 11,
                            $colSpan = 2,
                            $text = table[
                              $text   = {26124, 225},
                              $color  = 'Helper.color.grey',
                              $halign = 'center',
                            ],
                            $mouseOverText = {26124, 222},
                            $onClick = OnResetButtonClick,
                        ]"/>
            </actions>
        </cue>
        <cue name="OnResetButtonClick" instantiate="true">
            <conditions>
                <event_cue_signalled/>
            </conditions>
            <actions>
                <debug_text text="md.MCT_Config.Vault.$debugPrefix + 'button clicked'" chance="md.MCT_Config.Vault.$debugChance"/>
                <do_if value="md.MCT_Config.Vault.$customTabs.$resetConfirm == 0">
                    <signal_cue_instantly
                            cue="md.Simple_Menu_API.Update_Widget"
                            param="table[
                                $id = 'resetText',
                                $text = {26124, 223},
                                $color = 'Helper.color.red',
                            ]"/>
                </do_if>
                <do_else>
                    <signal_cue_instantly
                            cue="md.Simple_Menu_API.Update_Widget"
                            param="table[
                                $id = 'resetText',
                                $text = {26124, 224},
                                $color = 'Helper.color.green',
                            ]"/>
                    <raise_lua_event name="'mct.resetData'"/>
                </do_else>

                <cancel_cue cue="this"/>
            </actions>
        </cue>
        <cue name="OnCheckboxClick" instantiate="true">
            <conditions>
                <event_cue_signalled/>
            </conditions>
            <actions>
                <debug_text text="md.MCT_Config.Vault.$debugPrefix + event.param.$id + ' val: ' + event.param.$checked" chance="md.MCT_Config.Vault.$debugChance"/>
                <set_value name="md.MCT_Config.Vault.$customTabs.{'$' + event.param.$id}" exact="event.param.$checked"/>
                <cancel_cue cue="this"/>
            </actions>
        </cue>
        <cue name="OnSliderChange" instantiate="true">
            <conditions>
                <event_cue_signalled/>
            </conditions>
            <actions>
                <debug_text text="md.MCT_Config.Vault.$debugPrefix + event.param.$id + ' val: ' + event.param.$value" chance="md.MCT_Config.Vault.$debugChance"/>
                <set_value name="md.MCT_Config.Vault.$customTabs.{'$' + event.param.$id}" exact="event.param.$value"/>

                <signal_cue_instantly cue="md.Simple_Menu_API.Refresh_Menu"/>

                <cancel_cue cue="this"/>
            </actions>
        </cue>
        <cue name="OnDropDownChange" instantiate="true">
            <conditions>
                <event_cue_signalled/>
            </conditions>
            <actions>
                <set_value name="md.MCT_Config.Vault.$customTabs.{'$' + event.param.$id}" exact="event.param.$option.$value"/>
                <cancel_cue cue="this"/>
            </actions>
        </cue>
        <cue name="OnIconDropDownChange" instantiate="true">
            <conditions>
                <event_cue_signalled/>
            </conditions>
            <actions>
                <set_value name="md.MCT_Config.Vault.$customTabs.{'$tab' + event.param.$id}.$icon" exact="table[
                    $name = event.param.$option.$value,
                    $index = event.param.$option.$id,
                ]"/>
                <cancel_cue cue="this"/>
            </actions>
        </cue>

        <cue name="OnDropDownReorderFromChange" instantiate="true">
            <conditions>
                <event_cue_signalled/>
            </conditions>
            <actions>
                <set_value name="md.MCT_Config.OptionsMenu.$reorderIndexFrom" exact="event.param.$option.$orderNumber"/>
                <cancel_cue cue="this"/>
            </actions>
        </cue>
        <cue name="OnDropDownReorderToChange" instantiate="true">
            <conditions>
                <event_cue_signalled/>
            </conditions>
            <actions>
                <set_value name="md.MCT_Config.OptionsMenu.$reorderIndexTo" exact="event.param.$option.$orderNumber"/>
                <cancel_cue cue="this"/>
            </actions>
        </cue>
        <cue name="OnReorderButtonClick" instantiate="true">
            <conditions>
                <event_cue_signalled/>
            </conditions>
            <actions>
                <set_value name="$reorderIndexFrom" exact="@md.MCT_Config.OptionsMenu.$reorderIndexFrom"/>
                <set_value name="$reorderIndexTo" exact="@md.MCT_Config.OptionsMenu.$reorderIndexTo"/>

                <do_if value="$reorderIndexFrom gt 0 and $reorderIndexTo ge 0 and $reorderIndexFrom != $reorderIndexTo">
                    <set_value name="$newOrder" exact="[]"/>

                    <!-- in case of moving to the first position -->
                    <do_if value="$reorderIndexTo == 0">
                        <append_to_list name="$newOrder" exact="$reorderIndexFrom"/>
                    </do_if>

                    <do_for_each name="$order" in="md.MCT_Config.Vault.$customTabs.$order">
                        <do_if value="$order != $reorderIndexFrom">
                            <append_to_list name="$newOrder" exact="$order"/>
                            <!-- put the moved tab after the selected -->
                            <do_if value="$order == $reorderIndexTo">
                                <append_to_list name="$newOrder" exact="$reorderIndexFrom"/>
                            </do_if>
                        </do_if>
                    </do_for_each>

                    <set_value name="md.MCT_Config.Vault.$customTabs.$order" exact="$newOrder"/>

                    <remove_value name="$newOrder"/>
                    <remove_value name="md.MCT_Config.OptionsMenu.$reorderIndexFrom"/>
                    <remove_value name="md.MCT_Config.OptionsMenu.$reorderIndexTo"/>

                    <signal_cue_instantly cue="md.Simple_Menu_API.Refresh_Menu"/>

                </do_if>
                <cancel_cue cue="this"/>
            </actions>
        </cue>


        <cue name="OnEditBoxChanged" instantiate="true">
            <conditions>
                <event_cue_signalled/>
            </conditions>
            <actions>
                <debug_text text="md.MCT_Config.Vault.$debugPrefix + event.param.$id + ' val: ' + event.param.$text" chance="md.MCT_Config.Vault.$debugChance"/>
                <set_value name="md.MCT_Config.Vault.$customTabs.{'$tab' + event.param.$id}.$name" exact="event.param.$text"/>
                <cancel_cue cue="this"/>
            </actions>
        </cue>
        <cue name="OnEditBoxDeactivated" instantiate="true">
            <conditions>
                <event_cue_signalled/>
            </conditions>
            <actions>
                <debug_text text="md.MCT_Config.Vault.$debugPrefix + event.param.$id + ' val: ' + event.param.$text" chance="md.MCT_Config.Vault.$debugChance"/>
                <set_value name="md.MCT_Config.Vault.$customTabs.{'$tab' + event.param.$id}.$name" exact="event.param.$text"/>

                <signal_cue_instantly cue="md.Simple_Menu_API.Refresh_Menu"/>

                <cancel_cue cue="this"/>
            </actions>
        </cue>
        <cue name="OnOptionsMenuClose">
            <conditions>
                <event_ui_triggered screen="'OptionsMenu'" control="'menu_close'"/>
            </conditions>
            <actions>
                <debug_text text="md.MCT_Config.Vault.$debugPrefix + 'OnOptionsMenuClose'" chance="md.MCT_Config.Vault.$debugChance"/>
                <set_value name="player.entity.$customTabsConfig" exact="md.MCT_Config.Vault.$customTabs"/>
                <raise_lua_event name="'mct.updateConfig'"/>
                <reset_cue cue="this"/>
            </actions>
        </cue>

        <library name="Add_Icon_Actions">
            <actions>
                <!--
                        Formula to get column numbers as [1,3,5,7,9,11,1,3,5,7,9,11,1,3...]
                        y = 2* ((x-1) mod 6) - 1
                     -->
                <set_value name="$col" exact="2 * ( ($iconIndex-1) % 6 ) + 1"/>

                <signal_cue_instantly
                        cue="md.Simple_Menu_API.Make_Icon"
                        param="table[
                                    $width = 45,
                                    $height = 45,
                                    $x = 30,
                                    $col = $col,
                                    $colSpan = 2,
                                    $icon  = $icon,
                                    $mouseOverText = {26124, 232} + $iconIndex,
                                    $text = table[
                                      $text   =  {26124, 232} + ' ' + $iconIndex,
                                      $color  = 'Helper.color.grey',
                                      $halign = 'center',
                                      $x = 52,
                                      $y = 42,
                                    ],
                                ]"/>
                <set_value name="$iconIndex" operation="add"/>

                <do_if value="$col == 11">
                    <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" param="table[$selectable=false]"/>
                    <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text" param="table[$col=1, $text='']"/>
                    <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" param="table[$selectable=false]"/>
                </do_if>
            </actions>
        </library>

    </cues>
</mdscript>
